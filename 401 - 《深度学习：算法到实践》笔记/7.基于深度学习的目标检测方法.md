# 基于深度学习的目标检测方法

## 背景介绍

### 概念

- 什么是目标检测？
  - 对于一张图片，找到其中所有的物体，并给出其类别和边界框（Bounding box）
- 应用
  - 人脸检测
  - 行人检测
  - 车辆检测
  - 工业检测
  - 网络图片敏感信息检测
  - 公共安全
- 目标检测：人才缺口大 and 高薪资
  - 深度学习半视觉，视觉半目标检测
- 早期探索
  - 物理模型
  - 表观统计模型
  - 基于部件的模型（DPM）
- 近期工作：数据驱动

### 数据集

<img src="http://pz38o5vs6.bkt.clouddn.com/2019-10-20_11h14_10.jpg" alt="2019-10-20_11h14_10.jpg" style="zoom:67%;" />



<img src="http://pz38o5vs6.bkt.clouddn.com/2019-10-20_11h14_59.jpg" alt="2019-10-20_11h14_59.jpg" style="zoom:67%;" />

### 竞赛

- Pascal VOC
  - 20 classes
  - 停办
- COCO:200 classes
  - 2018年C0C0竞赛中国团队包揽全部六项任务的冠军，其中旷视取得4项冠军
- ImageNet ILSVRC 
  - 停办

### 挑战

- 太多尺度/位置的样本需要被测试！
- 目标可能存在的情况太多！

## 战前准备

### 评价准则

- 准确率（Precision）
- 召回率（Recall）
- 交并比（l0U，Intersection-over-Union）
- 平均准确率（AP，Average Precision）

### 滑动窗口

- Sliding Window
- 滑动窗口（从右到左，从上到下）

### 目标候选生成

- Object Proposal Generation
  - Selective Search(SS)
    - 类似于一种层次聚类算法
    - 目标检测中经常使用
  - Multiscale Combinatorial Grouping(MCG)

### 难样本挖掘

- Hard Negative Mining
- 对于正负训练样本的重视程度不同；
- 在训练过程中，给予难分的负样本更大的权重。

### 非极大值抑制

- Non-Maximum Suppression
- 顾名思义就是抑制不是极大值的元素
- 把与指定框overlap大于一定阈值（通常为0.5）的其他框移除

### 检测框回归

- Bounding Box Regression
- 对目标候选的位置进行精化（Refine）

## 两阶段方法

- 两阶段
  - 产生目标候选
  - 分类

### RCNN

- 2014年 CVPR
- 框架
  - 用Selective Search方法产生目标候选；
  - 利用CNN提特征；
  - 利用SVM分类。

![2019-10-20_11h28_08.jpg](http://pz38o5vs6.bkt.clouddn.com/2019-10-20_11h28_08.jpg)

- RCNN训练
  - 1.使用lmageNet等数据集，训练一个用于图片分类的CNN模型（或者使用现成的模型，如AlexNet等）
  - 2.根据检测类别和数据集Fine-Tune网络。以PASCAL VOC数据集为例，我们关注于20个类别+1个背景类。因此，移除之前最后一个FC层（ImageNet分类层），替换为一个小的FC层并进行Fine-Tune。
  - 3.对目标候选提CNN特征。
  - 4.对于每一种检测类，训练SVM。
- 为什么要单独训练SVM？
  - （1）CNN需要大量的训练样本（对样本质量的要求松）；
  - （2）SVM用少量的样本就可以训练（对样本质量的要求严）。
- 存在不足
  - 每个备选区域都进行特征提取，花费大量时间、空间且多有重叠部分
  - 训练过程分步完成不是end-to-end
  - Warp操作会使图片失真

### SPPNet



### Fast RCNN

### Faster-RCNN

### FPN

### RFCN



## 单阶段方法

### YOL0

### SSD

### Retinallet

## 荟萃：目标检测方法对比



## 10行代码实现目标检测（小Demo简要介绍）



## 拓展：视频中目标检测



## 总结





